<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Flymoon app</title>
    <!-- favicon -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='images/favicon.ico') }}">
    <!-- CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css?v=2"
        crossorigin=""/>
</head>
<body> 
    <h1>‚úàÔ∏è Flymoon <span id="targetIcon" onclick="toggleTarget();">-</span></h1>
    <h3 class="light-text">Target: <span id="targetLabel">-</span></h3>
    <p id="targetCoordinates"></p>
    <p id="weatherInfo" class="light-text-2"></p>
    <p id="trackingStatus" class="light-text-2"></p>

    <h4>My current position</h4>
    <div class="center-div">
        <form class="form-container" action="">
            <div class="form-group">
                <label for="flatitude">Latitude</label>
                <input type="number" id="latitude" name="flatitude" autocomplete="on">
            </div>
            <div class="form-group">
                <label for="flongitude">Longitude</label>
                <input type="number" id="longitude" name="flongitude" autocomplete="on">
            </div>
            <div class="form-group">
                <label for="fevelation">Elevation</label>
                <input type="number" id="elevation" name="fevelation" autocomplete="on">
            </div>
        </form>
    </div>

    <button class="secondary" onclick="savePosition()">Save position</button>
    <button class="secondary" onclick="clearPosition()">Clear</button>
    <button class="secondary" onclick="requestNotificationPermission()" title="Enable desktop notifications">üîî Enable Alerts</button>
    <button class="secondary" onclick="toggleMap()" title="Show/hide map visualization">üó∫Ô∏è Map</button>
    <br>

    <button id="goBtn" class="primary" onclick="go();">Go</button>
    <button id="autoBtn" class="primary" onclick="auto();">Auto</button>

    <div id="mapContainer" style="display: none;">
        <div id="map" style="height: 500px; width: 100%; margin: 20px 0;"></div>
        <div id="mapLegend" style="padding: 10px; background: #f0f0f0; margin-bottom: 10px;">
            <strong>Legend:</strong>
            <span style="margin-left: 10px;">üìç Observer</span>
            <span style="margin-left: 10px;">‚úàÔ∏è Aircraft</span>
            <span style="margin-left: 10px; color: #32CD32;">‚óÜ High</span>
            <span style="margin-left: 10px; color: #FF8C00;">‚óÜ Medium</span>
            <span style="margin-left: 10px; color: #FFD700;">‚óÜ Low</span>
            <span style="margin-left: 10px;"><span style="display: inline-block; width: 16px; height: 12px; border: 2px dashed red; vertical-align: middle;"></span> Bounding box</span>
            <span style="margin-left: 10px;"><span style="display: inline-block; width: 20px; height: 4px; background: #FF4500; vertical-align: middle;"></span> Azimuth</span>
        </div>
    </div>

    <div id="results">
        <table id="resultsTable">
            <thead>
                <tr>
                    <th>id</th>
                    <th>origin</th>
                    <th>destination</th>
                    <th>‚ñ≥alt</th>
                    <th>‚ñ≥az</th>
                    <th>ETA</th>
                    <th>target alt</th>
                    <th>plane alt</th>
                    <th>target az</th>
                    <th>plane az</th>
                    <th>elev change</th>
                    <th>dir</th>
                    <th>target</th>
                </tr>
            </thead>
            <tbody id="flightData">
            </tbody>
        </table>
    </div>
    <br>
    <h5 class="light-text-2">ETA is in minutes.</h5>
    <h5 class="light-text-2">Possible transits are highlighted by color: green for high probability, orange for medium, and yellow for low.</h5>
    <h5 id="autoGoNote"></h5>
    <h3 class="alert" id="noResults"></h3>
    <h3 class="alert" id="targetUnderHorizon"></h3>

    <audio id="alertSound" src="{{ url_for('static', filename='sounds/tissman-alert1-maximum-distortion.mp3') }}" preload="auto">
    </audio>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js?v=2"
        crossorigin=""></script>
    <!-- Leaflet Editable for draggable shapes -->
    <script src="https://unpkg.com/leaflet-editable@1.2.0/src/Leaflet.Editable.js"></script>
    <script src="{{ url_for('static', filename='map.js') }}" charset="utf-8"></script>
    <script src="{{ url_for('static', filename='app.js') }}" charset="utf-8"></script>

    <script>
        loadPosition();
    </script>
</body>
</html>