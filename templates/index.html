<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Flymoon app</title>
    <!-- favicon -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='images/favicon.ico') }}">
    <!-- CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css?v=2"
        crossorigin=""/>
</head>
<body>
    <div class="header-row">
        <span class="title">âœˆï¸ Flymoon</span>
        <span id="targetIcon" class="target-icon" onclick="toggleTarget();">-</span>
        <span id="targetLabel" class="target-label">-</span>
        <span id="weatherInfo" class="status-text"></span>
        <span id="trackingStatus" class="status-text"></span>
    </div>
    <p id="targetCoordinates" class="coords-text"></p>

    <div class="controls-row">
        <input type="number" id="latitude" placeholder="Lat" autocomplete="on" title="Latitude">
        <input type="number" id="longitude" placeholder="Lon" autocomplete="on" title="Longitude">
        <input type="number" id="elevation" placeholder="Elev" autocomplete="on" title="Elevation (m)">
        <button class="btn-sm" onclick="savePosition()" title="Save position">ğŸ’¾</button>
        <button class="btn-sm" onclick="clearPosition()" title="Clear">âœ•</button>
        <button class="btn-sm" onclick="requestNotificationPermission()" title="Enable alerts">ğŸ””</button>
        <button class="btn-sm" onclick="toggleMap()" title="Toggle map">ğŸ—ºï¸</button>
        <button id="goBtn" class="btn-primary" onclick="go();">Go</button>
        <button id="autoBtn" class="btn-primary" onclick="auto();">Auto</button>
    </div>

    <div id="mapContainer" style="display: none;">
        <div id="map" style="height: 500px; width: 100%; margin: 20px 0;"></div>
        <div id="mapLegend" style="padding: 10px; background: #f0f0f0; margin-bottom: 10px;">
            <strong>Legend:</strong>
            <span style="margin-left: 10px;">ğŸ“ Observer</span>
            <span style="margin-left: 10px;">âœˆï¸ Aircraft</span>
            <span style="margin-left: 10px; color: #32CD32;">â—† High</span>
            <span style="margin-left: 10px; color: #FF8C00;">â—† Medium</span>
            <span style="margin-left: 10px; color: #FFD700;">â—† Low</span>
            <span style="margin-left: 10px;"><span style="display: inline-block; width: 16px; height: 12px; border: 2px dashed red; vertical-align: middle;"></span> Bounding box</span>
            <span style="margin-left: 10px;"><span style="display: inline-block; width: 20px; height: 4px; background: #FF4500; vertical-align: middle;"></span> Sun azimuth</span>
            <span style="margin-left: 10px;"><span style="display: inline-block; width: 20px; height: 4px; background: #4169E1; vertical-align: middle;"></span> Moon azimuth</span>
        </div>
    </div>

    <div id="results">
        <table id="resultsTable">
            <thead>
                <tr>
                    <th></th>
                    <th>id</th>
                    <th>origin</th>
                    <th>destination</th>
                    <th>ETA</th>
                    <th>target alt</th>
                    <th>plane alt</th>
                    <th>â–³alt</th>
                    <th>target az</th>
                    <th>plane az</th>
                    <th>â–³az</th>
                    <th>elev</th>
                    <th>hdg</th>
                </tr>
            </thead>
            <tbody id="flightData">
            </tbody>
        </table>
    </div>
    <p id="autoGoNote" class="status-text"></p>
    <h3 class="alert" id="noResults"></h3>
    <h3 class="alert" id="targetUnderHorizon"></h3>

    <audio id="alertSound" src="{{ url_for('static', filename='sounds/tissman-alert1-maximum-distortion.mp3') }}" preload="auto">
    </audio>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js?v=2"
        crossorigin=""></script>
    <!-- Leaflet Editable for draggable shapes -->
    <script src="https://unpkg.com/leaflet-editable@1.2.0/src/Leaflet.Editable.js"></script>
    <script src="{{ url_for('static', filename='map.js') }}" charset="utf-8"></script>
    <script src="{{ url_for('static', filename='app.js') }}" charset="utf-8"></script>

    <script>
        loadPosition();
    </script>
</body>
</html>